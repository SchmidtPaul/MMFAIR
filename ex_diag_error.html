<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Heterogeneous error variance</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MMFAIR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="ex_diag_error.html">Examples</a>
</li>
<li>
  <a href="sources.html">Sources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Heterogeneous error variance</h1>

</div>


<p><strong>packages &amp; data</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">pacman<span class="op">::</span><span class="kw">p_load</span>(broom.mixed, dplyr, purrr, tibble, tidyr, <span class="co"># for data handling</span></a>
<a class="sourceLine" id="cb1-2" title="2">               nlme, lme4, glmmTMB, sommer) <span class="co"># packages for mixed models</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4">dat &lt;-<span class="st"> </span>agridat<span class="op">::</span>mcconway.turnip <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">densf =</span> <span class="kw">as.factor</span>(density))</a></code></pre></div>
<div id="motivation" class="section level1">
<h1>Motivation</h1>
<p>This is a randomized complete block design (4 blocks) with three treatment factors: genotype, date and density, leading to 16 treatment level combinations (2 genotypes, 2 planting dates, 4 densities) <a href="https://acsess.onlinelibrary.wiley.com/doi/abs/10.2134/agronj2008.0226x">(Piepho, 2009)</a>. It can be argued that heterogeneous error variances (<em>i.e.</em> heteroscedasticity) for two of the treatments should be considered:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">boxplot</span>(yield <span class="op">~</span><span class="st"> </span>date,    <span class="dt">data=</span>dat)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">boxplot</span>(yield <span class="op">~</span><span class="st"> </span>density, <span class="dt">data=</span>dat)</a></code></pre></div>
<p><img src="ex_diag_error_files/figure-html/unnamed-chunk-3-1.png" width="50%" /><img src="ex_diag_error_files/figure-html/unnamed-chunk-3-2.png" width="50%" /></p>
</div>
<div id="models" class="section level1 tabset tabset-fade tabset-pills">
<h1>4 Models</h1>
<p>We therefore set up 4 models, which only differ in the variance structure of the errors. More specifically, we allow for heterogeneous error variances / heteroscedascity per group for the effect levels of Date and Density. This variance structure is sometimes also referred to as <em>diagonal</em>.</p>
<p>Regarding the effects in the model, we take the same approach as <a href="https://acsess.onlinelibrary.wiley.com/doi/abs/10.2134/agronj2008.0226x">Piepho (2009)</a>, which calls for fixed main effects for <code>gen</code>, <code>date</code> and <code>densf</code> as well as all their interaction effects, plus random <code>block</code> effects.</p>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Term in multiplicative variance structure
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
Block
</th>
<th style="text-align:left;">
Genotype
</th>
<th style="text-align:left;">
Density
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span style=" font-weight: bold;    ">mod1</span>
</td>
<td style="text-align:left;">
Identity
</td>
<td style="text-align:left;">
Identity
</td>
<td style="text-align:left;">
Identity
</td>
<td style="text-align:left;">
Identity
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style=" font-weight: bold;    ">mod2</span>
</td>
<td style="text-align:left;">
Identity
</td>
<td style="text-align:left;">
Identity
</td>
<td style="text-align:left;">
Identity
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    ">Diagonal</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style=" font-weight: bold;    ">mod3</span>
</td>
<td style="text-align:left;">
Identity
</td>
<td style="text-align:left;">
Identity
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    ">Diagonal</span>
</td>
<td style="text-align:left;">
Identity
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style=" font-weight: bold;    ">mod4</span>
</td>
<td style="text-align:left;">
Identity
</td>
<td style="text-align:left;">
Identity
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    ">Diagonal</span>
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    ">Diagonal</span>
</td>
</tr>
</tbody>
</table>
<div id="nlme" class="section level2">
<h2>nlme</h2>
<p>To accomplish this in <code>nlme()</code>, we need to use the <em>variance function</em> <code>varIdent()</code> in the <code>weights=</code> statement, which is <em>used to allow for different variances according to the levels of a classification factor</em>. In model number 4, we are allowing for heterogeneous error variances for both dates and densities, which is done by combining two variance functions via <code>varComb()</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">mod1.nlme &lt;-<span class="st"> </span>nlme<span class="op">::</span><span class="kw">lme</span>(<span class="dt">fixed   =</span> yield <span class="op">~</span><span class="st"> </span>gen <span class="op">*</span><span class="st"> </span>date <span class="op">*</span><span class="st"> </span>densf, </a>
<a class="sourceLine" id="cb3-2" title="2">                       <span class="dt">random  =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span><span class="op">|</span>block,</a>
<a class="sourceLine" id="cb3-3" title="3">                       <span class="dt">weights =</span> <span class="ot">NULL</span>, <span class="co"># default, i.e. homoscedastic errors</span></a>
<a class="sourceLine" id="cb3-4" title="4">                       <span class="dt">data    =</span> dat)</a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6">mod2.nlme &lt;-<span class="st"> </span>mod1.nlme <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="st">  </span><span class="kw">update</span>(<span class="dt">weights =</span> <span class="kw">varIdent</span>(<span class="dt">form=</span><span class="op">~</span><span class="dv">1</span><span class="op">|</span>densf)) <span class="co"># one error variance per density</span></a>
<a class="sourceLine" id="cb3-8" title="8"></a>
<a class="sourceLine" id="cb3-9" title="9">mod3.nlme &lt;-<span class="st"> </span>mod1.nlme <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="st">  </span><span class="kw">update</span>(<span class="dt">weights =</span> <span class="kw">varIdent</span>(<span class="dt">form=</span><span class="op">~</span><span class="dv">1</span><span class="op">|</span>date))  <span class="co"># one error variance per date</span></a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12">mod4.nlme &lt;-<span class="st"> </span>mod1.nlme <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="st">  </span><span class="kw">update</span>(<span class="dt">weights =</span> <span class="kw">varComb</span>(<span class="kw">varIdent</span>(<span class="dt">form=</span><span class="op">~</span><span class="dv">1</span><span class="op">|</span>densf), <span class="co"># one error variance per </span></a>
<a class="sourceLine" id="cb3-14" title="14">                           <span class="kw">varIdent</span>(<span class="dt">form=</span><span class="op">~</span><span class="dv">1</span><span class="op">|</span>date))) <span class="co"># density-date combination</span></a></code></pre></div>
</div>
<div id="lme4" class="section level2">
<h2>lme4</h2>
<p><span style="color:red">in progress</span> <br/><br/><br/><br/></p>
</div>
<div id="glmmtmb" class="section level2">
<h2>glmmTMB</h2>
<p>In <code>glmmTMB()</code> it is -to our knowledge- not possible to adjust the variance structure of the error.</p>
<blockquote>
<p>Just like in <code>nlme</code>, there is a <code>weights=</code> option in <code>glmmTMB()</code>. However, to our understanding, they have different functions:</p>
<p>In <code>nlme</code>, it requires <em>“an optional <code>varFunc</code> object or one-sided formula describing the within-group heteroscedasticity structure”</em> <a href="https://cran.r-project.org/web/packages/glmmTMB/glmmTMB.pdf#Rfn.glmmTMB.1">(nlme RefMan)</a> and we make use of this in the example at hand.</p>
<p>In <code>glmmTMB</code>, the <a href="https://cran.r-project.org/web/packages/glmmTMB/glmmTMB.pdf#Rfn.glmmTMB.1">RefMan</a> only states <em>“weights, as in <code>glm</code>. Not automatically scaled to have sum 1”</em>. Following this trail, the <code>glm</code> documentation description for the <code>weights=</code> option is <em>“an optional vector of ‘prior weights’ to be used in the fitting process. Should be NULL or a numeric vector.”</em>. Accordingly, it cannot be used to allow for heterogeneous error variances in this package.</p>
</blockquote>
<p>We can, however, “<em>fix the residual variance to be 0 (actually a small non-zero value)</em>” and therefore “<em>force variance into the random effects</em>” <a href="https://cran.r-project.org/web/packages/glmmTMB/glmmTMB.pdf#Rfn.glmmTMB.1">(glmmTMB RefMan)</a> via adding the <code>dispformula = ~0</code> option. Thus, when doing so, we need to make sure to also add random term to the model with respective variance structure to the model that leads to the estimation of the desired variance components. In the case of mimicing the error variance as a random effect, we can create an <code>id</code> column in the data with different entries for each data point:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">dat.id &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>() <span class="op">%&gt;%</span><span class="st"> </span>as.factor) <span class="co"># new column with running number</span></a></code></pre></div>
<p>We should now be able to mimic the error variance via the random term <code>(1|id)</code>. We can verify this quickly, by modelling a <em>mod1</em> with a homoscedastic error variance in two different ways (<code>mod1</code>, <code>mod1b</code>). As can be seen below, both result in comparable variances. For <code>mod2</code>, <code>mod3</code> and <code>mod4</code>, we make use of the <code>diag()</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">mod1.glmm &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(<span class="dt">formula =</span>  yield <span class="op">~</span><span class="st"> </span>gen <span class="op">*</span><span class="st"> </span>date <span class="op">*</span><span class="st"> </span>densf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>block),</a>
<a class="sourceLine" id="cb5-2" title="2">                     <span class="dt">REML    =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb5-3" title="3">                     <span class="dt">data    =</span> dat.id) <span class="co"># default = homoscedastic error variance</span></a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5">mod1b.glmm &lt;-<span class="st"> </span>mod1.glmm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="st">  </span><span class="kw">update</span>(.<span class="op">~</span>. <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>id),   <span class="co"># add random term to mimic homoscedastic error variance</span></a>
<a class="sourceLine" id="cb5-7" title="7">         <span class="dt">dispformula=</span><span class="op">~</span><span class="dv">0</span>) <span class="co"># fix original error variance to 0 </span></a>
<a class="sourceLine" id="cb5-8" title="8"></a>
<a class="sourceLine" id="cb5-9" title="9">mod2.glmm &lt;-<span class="st"> </span>mod1.glmm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="st">  </span><span class="kw">update</span>(.<span class="op">~</span>. <span class="op">+</span><span class="st"> </span><span class="kw">diag</span>(date<span class="op">+</span><span class="dv">0</span><span class="op">|</span>id), <span class="dt">dispformula=</span><span class="op">~</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-11" title="11"></a>
<a class="sourceLine" id="cb5-12" title="12">mod3.glmm &lt;-<span class="st"> </span>mod1.glmm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="st">  </span><span class="kw">update</span>(.<span class="op">~</span>. <span class="op">+</span><span class="st"> </span><span class="kw">diag</span>(densf<span class="op">+</span><span class="dv">0</span><span class="op">|</span>id), <span class="dt">dispformula=</span><span class="op">~</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-14" title="14"></a>
<a class="sourceLine" id="cb5-15" title="15">mod4.glmm &lt;-<span class="st"> </span>mod1.glmm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="st">  </span><span class="kw">update</span>(.<span class="op">~</span>. <span class="op">+</span><span class="st"> </span><span class="kw">diag</span>(densf<span class="op">:</span>date<span class="op">+</span><span class="dv">0</span><span class="op">|</span>id), <span class="dt">dispformula=</span><span class="op">~</span><span class="dv">0</span>)</a></code></pre></div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">mod1.glmm <span class="op">%&gt;%</span><span class="st"> </span>VarCorr</a></code></pre></div>
<pre><code>## 
## Conditional model:
##  Groups   Name        Std.Dev.
##  block    (Intercept) 1.6768  
##  Residual             3.0970</code></pre>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">mod1b.glmm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">VarCorr</span>()</a></code></pre></div>
<pre><code>## 
## Conditional model:
##  Groups Name        Std.Dev.
##  block  (Intercept) 1.6764  
##  id     (Intercept) 3.0970</code></pre>
</div>
</div>
</div>
<div id="sommer" class="section level2">
<h2>sommer</h2>
<p><span style="color:red">in progress</span> <br/><br/><br/><br/></p>
</div>
</div>
<div id="variance-components" class="section level1 tabset tabset-fade tabset-pills">
<h1>Variance Components</h1>
<div id="nlme-1" class="section level2">
<h2>nlme</h2>
<p>As far as we know, it is quite cumbersome to extract variance component estimates from <code>nlme</code> objects (in a table format we are used to), even with helper packages such as <code>broom.mixed</code>. Beneath is the the most elegant approach we have so far when trying to get similarly formatted output for all 4 models. The general approach is to first get a table with a column for</p>
<ul>
<li>all levels / level-combinations for which heterogeneous error variances were fit</li>
<li>their respective value of the model-object’s <code>varStruct</code> and</li>
<li>the overall value of the model-object’s <code>sigma</code>.</li>
</ul>
<p>By multiplying the latter two, we receive the respective standard error estimate, which needs to be squared in order to obtain the respective variance component estimate.</p>
<p><strong>mod1</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">mod1.nlme.VC &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">grp=</span><span class="st">&quot;homoscedastic&quot;</span>, <span class="dt">varStruct=</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sigma         =</span> mod1.nlme<span class="op">$</span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">StandardError =</span> sigma<span class="op">*</span>varStruct) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Variance      =</span> StandardError<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
varStruct
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
StandardError
</th>
<th style="text-align:right;">
Variance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
homoscedastic
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.097
</td>
<td style="text-align:right;">
3.097
</td>
<td style="text-align:right;">
9.591
</td>
</tr>
</tbody>
</table>
<p><strong>mod2</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">mod2.nlme.VC &lt;-<span class="st"> </span>mod2.nlme<span class="op">$</span>modelStruct<span class="op">$</span>varStruct <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw">coef</span>(<span class="dt">unconstrained=</span><span class="ot">FALSE</span>, <span class="dt">allCoef=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">  </span><span class="kw">enframe</span>(<span class="dt">name=</span><span class="st">&quot;grp&quot;</span>, <span class="dt">value=</span><span class="st">&quot;varStruct&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sigma         =</span> mod2.nlme<span class="op">$</span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">StandardError =</span> sigma<span class="op">*</span>varStruct) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Variance      =</span> StandardError<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
varStruct
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
StandardError
</th>
<th style="text-align:right;">
Variance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.501
</td>
<td style="text-align:right;">
1.501
</td>
<td style="text-align:right;">
2.252
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
1.276
</td>
<td style="text-align:right;">
1.501
</td>
<td style="text-align:right;">
1.916
</td>
<td style="text-align:right;">
3.670
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
3.334
</td>
<td style="text-align:right;">
1.501
</td>
<td style="text-align:right;">
5.004
</td>
<td style="text-align:right;">
25.037
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
2.434
</td>
<td style="text-align:right;">
1.501
</td>
<td style="text-align:right;">
3.652
</td>
<td style="text-align:right;">
13.339
</td>
</tr>
</tbody>
</table>
<p><strong>mod3</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">mod3.nlme.VC &lt;-<span class="st"> </span>mod3.nlme<span class="op">$</span>modelStruct<span class="op">$</span>varStruct <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw">coef</span>(<span class="dt">unconstrained=</span><span class="ot">FALSE</span>, <span class="dt">allCoef=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">enframe</span>(<span class="dt">name=</span><span class="st">&quot;grp&quot;</span>, <span class="dt">value=</span><span class="st">&quot;varStruct&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sigma         =</span> mod3.nlme<span class="op">$</span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">StandardError =</span> sigma<span class="op">*</span>varStruct) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Variance      =</span> StandardError<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
varStruct
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
StandardError
</th>
<th style="text-align:right;">
Variance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
21Aug1990
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
2.075
</td>
<td style="text-align:right;">
2.075
</td>
<td style="text-align:right;">
4.306
</td>
</tr>
<tr>
<td style="text-align:left;">
28Aug1990
</td>
<td style="text-align:right;">
1.898
</td>
<td style="text-align:right;">
2.075
</td>
<td style="text-align:right;">
3.938
</td>
<td style="text-align:right;">
15.505
</td>
</tr>
</tbody>
</table>
<p><strong>mod4</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">mod4.nlme.varStruct.A &lt;-<span class="st"> </span>mod4.nlme<span class="op">$</span>modelStruct<span class="op">$</span>varStruct<span class="op">$</span>A <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">  </span><span class="kw">coef</span>(<span class="dt">unconstrained=</span><span class="ot">FALSE</span>, <span class="dt">allCoef=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw">enframe</span>(<span class="dt">name=</span><span class="st">&quot;grpA&quot;</span>, <span class="dt">value=</span><span class="st">&quot;varStructA&quot;</span>)</a>
<a class="sourceLine" id="cb13-4" title="4"></a>
<a class="sourceLine" id="cb13-5" title="5">mod4.nlme.varStruct.B &lt;-<span class="st"> </span>mod4.nlme<span class="op">$</span>modelStruct<span class="op">$</span>varStruct<span class="op">$</span>B <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="st">  </span><span class="kw">coef</span>(<span class="dt">unconstrained=</span><span class="ot">FALSE</span>, <span class="dt">allCoef=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="st">  </span><span class="kw">enframe</span>(<span class="dt">name=</span><span class="st">&quot;grpB&quot;</span>, <span class="dt">value=</span><span class="st">&quot;varStructB&quot;</span>)</a>
<a class="sourceLine" id="cb13-8" title="8"></a>
<a class="sourceLine" id="cb13-9" title="9">mod4.nlme.VC &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(mod4.nlme.varStruct.A<span class="op">$</span>grpA, </a>
<a class="sourceLine" id="cb13-10" title="10">                            mod4.nlme.varStruct.B<span class="op">$</span>grpB,</a>
<a class="sourceLine" id="cb13-11" title="11">                            <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">grpA=</span>Var1, <span class="dt">grpB=</span>Var2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="st">  </span><span class="kw">left_join</span>(<span class="dt">x=</span>., <span class="dt">y=</span>mod4.nlme.varStruct.A, <span class="dt">by=</span><span class="st">&quot;grpA&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="st">  </span><span class="kw">left_join</span>(<span class="dt">x=</span>., <span class="dt">y=</span>mod4.nlme.varStruct.B, <span class="dt">by=</span><span class="st">&quot;grpB&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sigma         =</span> mod4.nlme<span class="op">$</span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">StandardError =</span> sigma<span class="op">*</span>varStructA<span class="op">*</span>varStructB) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-17" title="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Variance      =</span> StandardError<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
grpA
</th>
<th style="text-align:left;">
grpB
</th>
<th style="text-align:right;">
varStructA
</th>
<th style="text-align:right;">
varStructB
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
StandardError
</th>
<th style="text-align:right;">
Variance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
21Aug1990
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.015
</td>
<td style="text-align:right;">
1.015
</td>
<td style="text-align:right;">
1.030
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
21Aug1990
</td>
<td style="text-align:right;">
1.482
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.015
</td>
<td style="text-align:right;">
1.503
</td>
<td style="text-align:right;">
2.260
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
21Aug1990
</td>
<td style="text-align:right;">
3.237
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.015
</td>
<td style="text-align:right;">
3.285
</td>
<td style="text-align:right;">
10.790
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
21Aug1990
</td>
<td style="text-align:right;">
2.772
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.015
</td>
<td style="text-align:right;">
2.813
</td>
<td style="text-align:right;">
7.910
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
28Aug1990
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.747
</td>
<td style="text-align:right;">
1.015
</td>
<td style="text-align:right;">
1.773
</td>
<td style="text-align:right;">
3.143
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
28Aug1990
</td>
<td style="text-align:right;">
1.482
</td>
<td style="text-align:right;">
1.747
</td>
<td style="text-align:right;">
1.015
</td>
<td style="text-align:right;">
2.627
</td>
<td style="text-align:right;">
6.900
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
28Aug1990
</td>
<td style="text-align:right;">
3.237
</td>
<td style="text-align:right;">
1.747
</td>
<td style="text-align:right;">
1.015
</td>
<td style="text-align:right;">
5.740
</td>
<td style="text-align:right;">
32.945
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
28Aug1990
</td>
<td style="text-align:right;">
2.772
</td>
<td style="text-align:right;">
1.747
</td>
<td style="text-align:right;">
1.015
</td>
<td style="text-align:right;">
4.914
</td>
<td style="text-align:right;">
24.151
</td>
</tr>
</tbody>
</table>
</div>
<div id="lme4-1" class="section level2">
<h2>lme4</h2>
<p><span style="color:red">in progress</span> <br/><br/><br/><br/></p>
</div>
<div id="glmmtmb-1" class="section level2">
<h2>glmmTMB</h2>
<p>In order to extract variance component estimates from <code>glmmTMB</code> objects (in a table format we are used to), we here use the function <code>tidy()</code> from the helper package <code>broom.mixed</code>.</p>
<p><strong>mod1</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">mod1.glmm.VC &lt;-<span class="st"> </span>mod1.glmm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">  </span><span class="kw">tidy</span>(<span class="dt">effects=</span><span class="st">&quot;ran_pars&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;vcov&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span><span class="kw">separate</span>(term, <span class="dt">sep=</span><span class="st">&quot;__&quot;</span>, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;term&quot;</span>,<span class="st">&quot;grp&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">  </span><span class="kw">filter</span>(group<span class="op">==</span><span class="st">&quot;Residual&quot;</span>)</a></code></pre></div>
<table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
component
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
Observation
</td>
<td style="text-align:right;">
9.591
</td>
</tr>
</tbody>
</table>
<p><strong>mod2</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">mod2.glmm.VC &lt;-<span class="st"> </span>mod2.glmm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">  </span><span class="kw">tidy</span>(<span class="dt">effects=</span><span class="st">&quot;ran_pars&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;vcov&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="st">  </span><span class="kw">separate</span>(term, <span class="dt">sep=</span><span class="st">&quot;__&quot;</span>, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;term&quot;</span>,<span class="st">&quot;grp&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="st">  </span><span class="kw">filter</span>(group<span class="op">==</span><span class="st">&quot;id&quot;</span>, term<span class="op">==</span><span class="st">&quot;var&quot;</span>)</a></code></pre></div>
<table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
component
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
date21Aug1990
</td>
<td style="text-align:right;">
4.306
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
date28Aug1990
</td>
<td style="text-align:right;">
15.505
</td>
</tr>
</tbody>
</table>
<p><strong>mod3</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">mod3.glmm.VC &lt;-<span class="st"> </span>mod3.glmm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="st">  </span><span class="kw">tidy</span>(<span class="dt">effects=</span><span class="st">&quot;ran_pars&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;vcov&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span><span class="kw">separate</span>(term, <span class="dt">sep=</span><span class="st">&quot;__&quot;</span>, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;term&quot;</span>,<span class="st">&quot;grp&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="st">  </span><span class="kw">filter</span>(group<span class="op">==</span><span class="st">&quot;id&quot;</span>, term<span class="op">==</span><span class="st">&quot;var&quot;</span>)</a></code></pre></div>
<table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
component
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf1
</td>
<td style="text-align:right;">
2.252
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf2
</td>
<td style="text-align:right;">
3.669
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf4
</td>
<td style="text-align:right;">
25.037
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf8
</td>
<td style="text-align:right;">
13.338
</td>
</tr>
</tbody>
</table>
<p><strong>mod4</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">mod4.glmm.VC &lt;-<span class="st"> </span>mod4.glmm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw">tidy</span>(<span class="dt">effects=</span><span class="st">&quot;ran_pars&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;vcov&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="st">  </span><span class="kw">separate</span>(term, <span class="dt">sep=</span><span class="st">&quot;__&quot;</span>, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;term&quot;</span>,<span class="st">&quot;grp&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="st">  </span><span class="kw">filter</span>(group<span class="op">==</span><span class="st">&quot;id&quot;</span>, term<span class="op">==</span><span class="st">&quot;var&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="st">  </span><span class="kw">separate</span>(grp, <span class="dt">sep=</span><span class="st">&quot;:&quot;</span>, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;grp1&quot;</span>,<span class="st">&quot;grp2&quot;</span>))</a></code></pre></div>
<table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
component
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
grp1
</th>
<th style="text-align:left;">
grp2
</th>
<th style="text-align:right;">
estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf1
</td>
<td style="text-align:left;">
date21Aug1990
</td>
<td style="text-align:right;">
0.880
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf2
</td>
<td style="text-align:left;">
date21Aug1990
</td>
<td style="text-align:right;">
3.081
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf4
</td>
<td style="text-align:left;">
date21Aug1990
</td>
<td style="text-align:right;">
6.262
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf8
</td>
<td style="text-align:left;">
date21Aug1990
</td>
<td style="text-align:right;">
9.759
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf1
</td>
<td style="text-align:left;">
date28Aug1990
</td>
<td style="text-align:right;">
3.446
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf2
</td>
<td style="text-align:left;">
date28Aug1990
</td>
<td style="text-align:right;">
4.997
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf4
</td>
<td style="text-align:left;">
date28Aug1990
</td>
<td style="text-align:right;">
48.092
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
id
</td>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
densf8
</td>
<td style="text-align:left;">
date28Aug1990
</td>
<td style="text-align:right;">
19.937
</td>
</tr>
</tbody>
</table>
</div>
<div id="sommer-1" class="section level2">
<h2>sommer</h2>
<p><span style="color:red">in progress</span> <br/><br/><br/><br/></p>
</div>
</div>
<div id="model-fit" class="section level1 tabset tabset-fade tabset-pills">
<h1>Model Fit</h1>
<p>As is standard procedure, we can do a model selection based on goodness-of-fit statistics such as the AIC. In order to have a direct comparison to Table 1 in <a href="https://acsess.onlinelibrary.wiley.com/doi/abs/10.2134/agronj2008.0226x">(Piepho, 2009)</a>, we also calculated the deviance (<em>i.e.</em> -2*loglikelihood) for each model. The code is shown for mod1:</p>
<div id="nlme-2" class="section level2">
<h2>nlme</h2>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">mod1.nlme <span class="op">%&gt;%</span><span class="st"> </span>AIC <span class="co"># AIC </span></a></code></pre></div>
<pre><code>## [1] 308.1365</code></pre>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="dv">-2</span> <span class="op">*</span><span class="st"> </span><span class="kw">logLik</span>(mod1.nlme) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Deviance</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="st">  </span>as.double </a></code></pre></div>
<pre><code>## [1] 272.1365</code></pre>
</div>
</div>
<table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
Deviance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
mod1
</td>
<td style="text-align:right;">
308.1365
</td>
<td style="text-align:right;">
272.1365
</td>
</tr>
<tr>
<td style="text-align:left;">
mod2
</td>
<td style="text-align:right;">
298.3167
</td>
<td style="text-align:right;">
256.3167
</td>
</tr>
<tr>
<td style="text-align:left;">
mod3
</td>
<td style="text-align:right;">
301.9271
</td>
<td style="text-align:right;">
263.9271
</td>
</tr>
<tr>
<td style="text-align:left;">
mod4
</td>
<td style="text-align:right;">
294.2643
</td>
<td style="text-align:right;">
250.2643
</td>
</tr>
</tbody>
</table>
</div>
<div id="lme4-2" class="section level2">
<h2>lme4</h2>
<p><span style="color:red">in progress</span> <br/><br/><br/><br/></p>
</div>
<div id="glmmtmb-2" class="section level2">
<h2>glmmTMB</h2>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">mod1.glmm <span class="op">%&gt;%</span><span class="st"> </span>AIC <span class="co"># AIC </span></a></code></pre></div>
<pre><code>## [1] 308.1365</code></pre>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="dv">-2</span> <span class="op">*</span><span class="st"> </span><span class="kw">logLik</span>(mod1.glmm) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Deviance</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="st">  </span>as.double </a></code></pre></div>
<pre><code>## [1] 272.1365</code></pre>
</div>
</div>
<table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
Deviance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
mod1
</td>
<td style="text-align:right;">
308.1365
</td>
<td style="text-align:right;">
272.1365
</td>
</tr>
<tr>
<td style="text-align:left;">
mod2
</td>
<td style="text-align:right;">
301.9272
</td>
<td style="text-align:right;">
263.9272
</td>
</tr>
<tr>
<td style="text-align:left;">
mod3
</td>
<td style="text-align:right;">
298.3167
</td>
<td style="text-align:right;">
256.3167
</td>
</tr>
<tr>
<td style="text-align:left;">
mod4
</td>
<td style="text-align:right;">
298.2036
</td>
<td style="text-align:right;">
248.2036
</td>
</tr>
</tbody>
</table>
</div>
<div id="sommer-2" class="section level2">
<h2>sommer</h2>
<p><span style="color:red">in progress</span> <br/><br/><br/><br/></p>
</div>
</div>

&nbsp;
<hr />
<p style="text-align: center;">Please feel free to contact us about any of this! </p>
<p style="text-align: center;"><span style="color: #808080;"><em>schmidtpaul@hotmail.de</em></span></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://www.linkedin.com/in/schmidtpaul1989/" class="fa fa-linkedin"></a>
    <a href="https://www.xing.com/profile/Paul_Schmidt203/cv/" class="fa fa-xing"></a>
    <a href="https://www.researchgate.net/profile/Paul_Schmidt17/research/" class="fa fa-pencil"></a>
    <a href="https://github.com/SchmidtPaul/" class="fa fa-github"></a>
</p>

&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
